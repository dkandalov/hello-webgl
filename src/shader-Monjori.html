<!DOCTYPE html>
<!-- saved from url=(0045)http://threejs.org/examples/webgl_shader.html -->
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>three.js webgl - shader [Monjori]</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
        body {
            color: #ffffff;
            font-family: Monospace,serif;
            font-size: 13px;
            text-align: center;
            font-weight: bold;

            background-color: #000000;
            margin: 0px;
            overflow: hidden;
        }

        #info {
            position: absolute;
            top: 0px;
            width: 100%;
            padding: 5px;
        }

        a {

            color: #ffffff;
        }

        #oldie a {
            color: #da0
        }
    </style>
</head>
<body>
<script src="../script/three.js"></script>
<script src="../script/Detector.js"></script>
<script src="../script/stats.min.js"></script>

<div id="container"></div>
<div id="info">
    <a href="http://threejs.org/" target="_blank">three.js</a> - shader demo. featuring
    <a href="http://www.pouet.net/prod.php?which=52761" target="_blank">Monjori by Mic</a>
</div>

<script id="vertexShader" type="x-shader/x-vertex">
    void main() {
        gl_Position = vec4(position, 1);
    }
</script>
<script id="fragmentShader" type="x-shader/x-fragment">
    uniform vec2 resolution;
    uniform float time;

    void main() {
        vec2 position = -1.0 + 2.0 * gl_FragCoord.xy / resolution.xy;
        float scaledTime = time * 40.0;
        float g = 1.0 / 40.0;
        float width = 400.0;

        float x = width * (position.x * 0.5 + 0.5);
        float y = width * (position.y * 0.5 + 0.5);
        float length = sqrt(pow(width / 2.0 - x, 2.0) + pow(width / 2.0 - y, 2.0));
        float lengthScaled = length / 350.0;
        float q = y / length;

        float e = length * cos(q) - scaledTime / 2.0;
        float f = length * sin(q) - scaledTime / 2.0;
        float h = ((f + sin(e * g) * 340.0 + length) + scaledTime / 2.0) * g;
        float i = cos(h + length * position.x / 1.3) * (e + e + scaledTime) + cos(q * g * 6.0) * (length + h / 3.0);
        h = sin(f * g) * 144.0 - sin(e * g) * 212.0 * position.x;
        h = (h + (f - e) * q + sin(length - (scaledTime + h) / 7.0) * 10.0 + i / 4.0) * g;
        i += cos(h * 2.3 * sin(scaledTime/ 350.0 - q)) * 184.0 * sin(q - (length * 4.3 + scaledTime / 12.0) * g) + tan(length * g + h) * 184.0 * cos(length * g + h);
        i = mod(i / 5.6, 256.0) / 64.0;
        if (i < 0.0) i += 4.0;
        if (i >= 2.0) i = 4.0 - i;
        lengthScaled += sin(lengthScaled * lengthScaled * 8.0) * 0.52;
        f = (sin(scaledTime * g) + 1.0) / 2.0;

        gl_FragColor = vec4(
            vec3(f * i / 1.6, i / 2.0 + lengthScaled / 13.0, i) * lengthScaled * position.x +
            vec3(i / 1.3 + lengthScaled / 8.0, i / 2.0 + lengthScaled / 18.0, i) * lengthScaled * (1.0 - position.x),
            1.0
        );
    }
</script>

<script>
    if (!Detector.webgl) Detector.addGetWebGLMessage();

    var stats;
    var camera, scene, renderer;
    var uniforms;
    var mouseX = 0, mouseY = 0,
        lat = 0, lon = 0, phy = 0, theta = 0;

    init();
    animate();

    function init() {
        var container = document.getElementById('container');

        camera = new THREE.Camera();
        camera.position.z = 1;
        scene = new THREE.Scene();

        uniforms = {
            time: { type: "f", value: 1.0 },
            resolution: { type: "v2", value: new THREE.Vector2() }
        };

        var material = new THREE.ShaderMaterial({
            uniforms: uniforms,
            vertexShader: document.getElementById('vertexShader').textContent,
            fragmentShader: document.getElementById('fragmentShader').textContent
        });

        scene.add(new THREE.Mesh(new THREE.PlaneGeometry(2, 2), material));

        renderer = new THREE.WebGLRenderer();
        container.appendChild(renderer.domElement);

        stats = new Stats();
        stats.domElement.style.position = 'absolute';
        stats.domElement.style.top = '0px';
        container.appendChild(stats.domElement);

        onWindowResize();

        window.addEventListener('resize', onWindowResize, false);
    }

    function onWindowResize() {
        uniforms.resolution.value.x = window.innerWidth;
        uniforms.resolution.value.y = window.innerHeight;
        renderer.setSize(window.innerWidth, window.innerHeight);
    }

    function animate() {
        requestAnimationFrame(animate);
        render();
        stats.update();
    }

    function render() {
        uniforms.time.value += 0.05;
        renderer.render(scene, camera);
    }
</script>
</body>
</html>